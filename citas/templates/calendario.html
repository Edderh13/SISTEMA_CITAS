{% extends "base.html" %}

{% block extra_css %}
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet">
{% endblock %}

{% block extra_js_head %}
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
{% endblock %}

{% block content %}
<h1>CALENDARIO DE CITAS</h1>
<div id="calendar"></div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener("DOMContentLoaded", function () {

    var calendarEl = document.getElementById("calendar");

    var calendar = new FullCalendar.Calendar(calendarEl, {
        selectable: true,
        selectMirror: true,
        locale: "es",
        initialView: "timeGridWeek",

        headerToolbar: {
            left: "prev,next today",
            center: "title",
            right: "dayGridMonth,timeGridWeek,timeGridDay"
        },

        slotMinTime: "06:00:00",
        slotMaxTime: "22:00:00",

        slotLabelFormat: {
            hour: "numeric",
            minute: "2-digit",
            hour12: true
        },

        dayHeaderFormat: {
            weekday: "short",
            day: "2-digit"
        },

        events: "/citas/api/citas/",

        dateClick: function (info) {
            window.location.href = `/citas/nueva/?fecha=${info.dateStr}`;
        },

        select: function (info) {
            window.location.href = `/citas/nueva/?inicio=${info.startStr}&fin=${info.endStr}`;
        }
    });

    calendar.render();
});
</script>
{% endblock %}
