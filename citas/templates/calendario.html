{% extends "base_panel.html" %}
{% load static %}

{% block title %}Calendario de Citas | BIOCURE MX{% endblock %}

{% block extra_head %}
    <!-- FullCalendar (GLOBAL MODE) -->
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>

    <style>
        #calendar {
            margin-top: 10px;
            background: #ffffff;
            border-radius: 14px;
            padding: 12px;
            box-shadow: 0 8px 22px rgba(15, 23, 42, 0.06);
        }

        .fc-toolbar-title {
            font-size: 16px !important;
            font-weight: 700 !important;
            letter-spacing: .08em;
        }

        .fc .fc-button {
            text-transform: uppercase;
            font-size: 11px;
            border-radius: 999px;
        }

        .fc-timegrid-slot-label {
            text-transform: lowercase;
        }
    </style>
{% endblock %}

{% block content %}
    <h1 class="page-title">CALENDARIO DE CITAS</h1>
    <p class="page-subtitle">
        Visualiza y gestiona las citas de todas tus sucursales.
    </p>

    <div class="card">
        <div class="card-header">
            <span class="card-title">AGENDA SEMANAL</span>
        </div>
        <div id="calendar"></div>
    </div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener("DOMContentLoaded", function () {
    var calendarEl = document.getElementById("calendar");

    var calendar = new FullCalendar.Calendar(calendarEl, {
        selectable: true,
        selectMirror: true,
        locale: "es",
        initialView: "timeGridWeek",

        headerToolbar: {
            left: "prev,next today",
            center: "title",
            right: "dayGridMonth,timeGridWeek,timeGridDay"
        },

        slotMinTime: "06:00:00",
        slotMaxTime: "22:00:00",

        slotLabelFormat: {
            hour: "numeric",
            minute: "2-digit",
            hour12: true
        },

        dayHeaderFormat: {
            weekday: "short",
            day: "2-digit"
        },

        events: "/citas/api/citas/",

        dateClick: function (info) {
            let fecha = info.dateStr;
            window.location.href = `/citas/nueva/?fecha=${fecha}`;
        },

        select: function (info) {
            let inicio = info.startStr;
            let fin = info.endStr;
            window.location.href = `/citas/nueva/?inicio=${inicio}&fin=${fin}`;
        }
    });

    calendar.render();
});
</script>
{% endblock %}
